# This GitHub Actions workflow was auto-generated by the `rdme` cli on 2023-02-23T16:30:24.884Z
# You can view our full documentation here: https://docs.readme.com/docs/rdme or https://github.com/readmeio/rdme
name: ReadMe GitHub Action ðŸ¦‰

on:
  push:
    branches:
      # This workflow will run every time you push code to the following branch.
      # Check out GitHub's docs for more info on configuring this:
      # https://docs.github.com/actions/using-workflows/events-that-trigger-workflows
      - v4.2

# I have multiple categories in seatable.readme.io:
# - SeaTable API (docs only)                    < intro/*.md
# - Authentication (ordner)                     < authentication.yml
# - Base Operations (ordner)                    < base_operations.yml
# - User Account Operations (ordner)            < user_account_operations.yml
# - Team-Admin Account Operations (ordner)      < team_admin_account_operations.yml
# - Admin Account Operations (ordner)           < admin_account_operations.yml
# - Ping and Server Info (nur highlevel ...)    < ping_and_info.yml

# Docs + API in API Reference
# These docs can live either in your Guides section or API Reference section! Think about it this way:
# Sync'ing the openapi file in Github Actions will generate your API endpoint pages with the necessary parameters, URLs, etc. This is our Explorer feature (i.e. Try it!)

# Sync'ing the Markdown files in Github Actions is a separate feature using 'rdme docs' functionality. You can see a sample of our repo that sync's the page I linked above:
# https://github.com/readmeio/rdme/blob/main/documentation/rdme.md
# You'll need to create pages with the correct frontmatter header, and create the correct Github Sync job. Here's an example of how we sync our docs:
# https://github.com/readmeio/rdme/blob/main/.github/workflows/docs.yml
# It's possible to sync Markdown on top of your API Reference! You'll need to include the isReference: true field in frontmatter so it knows that it's sync'ing a Markdown page in your API Reference section (on top of the sync'd OpenAPI endpoint pages!). I believe any field you find from a GET doc call, can be used in frontmatter!
# You'd use the same slug that the openapi sync created, but that's about it! Keep in mind, you'd need to sync OpenAPI first then the Markdown if you're changing content within your Reference sections, as it may be possible to delete Markdown content by mistake!

# Process for new version:
# local: git checkout -b v4.1
# Login to https://dash.readme.com/login and fork the openapi-definition for seatable.readme.io to a newer version.
# Switch to the latest reference page https://dash.readme.com/project/seatable/v4.1/reference and get the new IDs
# replace the --id=... values in this rdme-openapi.yml file.
# change all 4.0 occurances to 4.1
# Get the categories via API: https://docs.readme.com/main/reference/getcategories. You will need only the API key as password. username stays empty. x-readme-version has to be v4.1 or newer.
# get the _id of title: "SeaTable API"
# replace in all markdown files "intro" the category values
# replace in all yaml files the version
# local: git add . && git commit && git push --set-upstream origin v4.1

## old description
# 0. create new branch at github. Fork the openapi-definition at seatable.readme.io
# 1. Switch the `branch` in this file at the top of this file
# 2. Get the new IDs for all API reference categories from seatable.readme.io (available at https://dash.readme.com/project/seatable/v4.0/reference and update the `--id` values in this workflow file.
# in the Markdown-files, the `category` has to be updated. # > you will need the `_id` of title: SeaTable API

jobs:
  rdme-openapi:
    runs-on: ubuntu-latest
    steps:
      - name: Check out repo ðŸ“š
        uses: actions/checkout@v3

      # SeaTable API (docs only)
      - name: Update SeaTable API ðŸš€
        uses: readmeio/rdme@v8
        with:
          rdme: docs ./intro --key=${{ secrets.README_API_KEY }} --version=4.2

      # authentication
      - name: Update authentication ðŸš€
        uses: readmeio/rdme@v8
        with:
          rdme: openapi authentication.yaml --key=${{ secrets.README_API_KEY }} --id=65489cddc89ba30035c0d624 --useSpecVersion

      # base operations
      - name: Update base operations ðŸš€
        uses: readmeio/rdme@v8
        with:
          rdme: openapi base_operations.yaml --key=${{ secrets.README_API_KEY }} --id=65489cddc89ba30035c0d625 --useSpecVersion

      # Account operations: System admin
      - name: Update sys admin account operations ðŸš€
        uses: readmeio/rdme@v8
        with:
          rdme: openapi system_admin_account_operations.yaml --key=${{ secrets.README_API_KEY }} --id=65489cddc89ba30035c0d628 --useSpecVersion

      # Account operations: Team admin
      - name: Update team admin account operations ðŸš€
        uses: readmeio/rdme@v8
        with:
          rdme: openapi team_admin_account_operations.yaml --key=${{ secrets.README_API_KEY }} --id=65489cddc89ba30035c0d627 --useSpecVersion

      # Account operations: User
      - name: Update user account operations ðŸš€
        uses: readmeio/rdme@v8
        with:
          rdme: openapi user_account_operations.yaml --key=${{ secrets.README_API_KEY }} --id=65489cddc89ba30035c0d629 --useSpecVersion

      # ping & info
      - name: Update ping & info ðŸš€
        uses: readmeio/rdme@v8
        with:
          rdme: openapi ping_and_info.yaml --key=${{ secrets.README_API_KEY }} --id=65489cddc89ba30035c0d626 --useSpecVersion
